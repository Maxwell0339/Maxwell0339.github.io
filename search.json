[{"title":"ä¸ºä»€ä¹ˆæˆ‘æƒ³å»ºç«‹è‡ªå·±çš„åšå®¢ç½‘ç«™","path":"/2025/03/23/20250324/","content":"è·ç¦»æˆ‘ä¸Šä¸€æ¬¡æ¥è§¦ â€œåšå®¢â€ è¿™ä¸¤ä¸ªå­—ï¼Œè¿˜æ˜¯åå‡ å¹´å‰ã€‚é‚£æ—¶æœ‰ä¸ªç½‘ç«™å«åšæ–°æµªåšå®¢ï¼Œè®°å¾—æˆ‘æŒ‰ç…§ä¿¡æ¯è¯¾çš„æ•™æä¸Šé¢çš„æŒ‡å¯¼æ³¨å†Œäº†è‡ªå·±çš„ç¬¬ä¸€ä¸ªåšå®¢è´¦å·ã€‚å¦‚ä»Šè¿™ä¸ªç½‘ç«™å¥½åƒå·²ç»æ²¡æœ‰äººç»´æŠ¤äº†ï¼Œå½“å¹´çš„è´¦å·ä¹Ÿå·²ç»å¿˜è®°ã€‚ è¿™ä¸ªåšå®¢è¯ç”Ÿçš„åŠ¨åŠ› åªæ˜¯æƒ³æ‰¾ä¸ªå­˜å‚¨è‡ªå·±æ–‡æ¡£çš„åœ°æ–¹ï¼ï¼ï¼ é‚£ä¸ºå•¥è¿˜å¤§è´¹å‘¨ç« çš„å»æ­å»ºä¸€ä¸ªåšå®¢ç½‘ç«™å‘¢ï¼Ÿ ç”±äºä¹‹é—´æˆ‘çš„ç”µè„‘å‡ºç°äº†ç¡¬ç›˜æŸåçš„äº‹æ•…ï¼Œæœ¬åœ°å­˜å‚¨åœ¨æˆ‘å¿ƒä¸­ç•™ä¸‹äº†ä¸€é“å°è®°ã€‚æ‰€ä»¥æˆ‘ä¹Ÿå¼€å§‹é€‰æ‹©åœ¨äº‘ç«¯å­˜å‚¨ç€ä¸€äº›é‡è¦çš„æ•°æ®ã€‚ğŸ˜”ä½†æ˜¯å›½å†…å¸¸ç”¨çš„ç½‘ç›˜å…è´¹å­˜å‚¨ç©ºé—´ä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼ˆæ²Ÿæ§½çš„bdå’Œkkï¼‰ï¼Œæ‰€ä»¥å°±æŠŠç›®å…‰è½¬å‘äº†Githubï¼š100Mä»¥å†…çš„å•ä¸ªæ–‡ä»¶ï¼Œ5GBä»¥å†…çš„ä»“åº“ï¼Œä»“åº“æ•°é‡ä¸é™ã€‚ ç¡®å®å¾ˆè¯±äººï¼ï¼ï¼ ç«é€Ÿå¼€å§‹åˆ›å»ºä¸€äº›repoï¼ŒæŠŠä¸€äº›æ–‡æ¡£ä¸Šä¼ ï¼Œåšå¥½å½’ç±»ã€‚ ä½†ï¼šæ„Ÿè§‰è¿˜æ˜¯æ²¡å†…å‘³ã€‚å•è°ƒçš„ä¸ªäººç•Œé¢ï¼Œä»¥åŠä¸ç¨³å®šçš„ç½‘ç»œï¼Œè¿˜æ„Ÿè§‰ç¼ºç‚¹ä¸ªæ€§åŒ–ã€‚ã€‚ã€‚ æ¬¸ï¼Œä¹‹å‰æŸ¥é˜…èµ„æ–™æ—¶çœ‹åˆ°è¿‡åˆ«äººçš„åšå®¢ç½‘ç«™ï¼Œä½¿ç”¨ç•Œé¢é‚£å«ä¸€ä¸ªåä¸½ï¼Œè¿˜æœ‰ä¸€äº›æœ‰ç”¨çš„èµ„æ–™ã€‚ é‚£æˆ‘ä¹Ÿå¯ä»¥å»ºç«‹ä¸€ä¸ªè¿™æ ·çš„åšå®¢ç½‘ç«™ï¼Œä¸ä»…èƒ½å­˜å‚¨ä¸€äº›å­¦ä¹ æ–‡æ¡£ï¼Œå¹¶ä¸”ç•Œé¢è¿˜èƒ½æŒ‰ç…§æˆ‘çš„å–œå¥½è‡ªå®šä¹‰ğŸ˜„ äºæ˜¯è¿™ä¸ªç½‘ç«™å°±è¯ç”Ÿäº†ã€‚ï¼ˆå¬èµ·æ¥å¥½åƒæŒºæ‰¯æ·¡çš„ã€‚ã€‚ã€‚ï¼‰ ä½†æ˜¯ä½œä¸ºä¸€ä¸ªæ²¡æœ‰æ¥è§¦è¿‡å‰ç«¯çš„äººï¼Œæƒ³ä»é›¶å¼€å§‹è°ˆä½•å®¹æ˜“ã€‚åœ¨ç½‘ä¸Šæœäº†ä¸€æ®µæ—¶é—´çš„èµ„æ–™åï¼ŒèŠ±äº†ä¸€ä¸ªæ™šä¸Šï¼Œå­¦ç€ç”¨hexoå’Œstellaræ¨¡æ¿æ­å»ºå‡ºäº†è¿™ä¸ªåšå®¢ç½‘ç«™é›å½¢ã€‚ åšå®¢å†…å®¹è¿™ä¸ªåšå®¢ç½‘ç«™çš„å†…å®¹å°±å¦‚å‰é¢æ‰€è®²ï¼Œä¼šæ”¾ä¸€äº›æˆ‘ä¸ªäººå†™çš„å­¦ä¹ ç¬”è®°ä¹‹ç±»çš„ã€‚ä¸æ•¢å¯¹å†…å®¹çš„æ­£ç¡®æ€§åšå‡ºç»å¯¹çš„ä¿è¯ï¼Œå¸Œæœ›å‘ç°é”™è¯¯èƒ½åŠæ—¶æŒ‡å‡ºï¼ï¼ï¼ ç›®å‰è¿™ä¸ªç½‘ç«™åªæœ‰é˜…è¯»æ–‡æœ¬å’Œè¯„è®ºçš„åŠŸèƒ½ï¼Œåé¢ä¼šå­¦ç€å»åŠ ä¸€äº›æœ‰è¶£çš„ç»„ä»¶çš„ã€‚ æ•¬è¯·æœŸå¾…ï¼","tags":["åšå®¢"],"categories":["æ‚è°ˆ"]},{"path":"/notes/index.html","content":"å†™åœ¨å‰é¢ç¬”è®°å–µ"},{"title":"ADC","path":"/wiki/lanqiao/ADC.html","content":"åµŒå…¥å¼ADCåœ¨cubemxä¸­é€‰æ‹©PB12ï¼ŒPB15åˆ†åˆ«è®¾ç½®ä¸ºADCè¾“å‡ºæ¨¡å¼ï¼ˆADC1_IN11å’ŒADC2_IN15ï¼‰ ç”Ÿæˆä»£ç åï¼Œåœ¨adc.cæ–‡ä»¶ä¸­å†™å•é€šé“é‡‡æ ·å‡½æ•°ï¼Œéœ€è¦åœ¨adc.hæ–‡ä»¶ä¸­å£°æ˜ 1234567double getADC(ADC_HandleTypeDef *pin)&#123; uint16_t adc; HAL_ADC_Start(pin); adc = HAL_ADC_GetValue(pin); return adc*3.3/4096;&#125; åœ¨ä¸»å‡½æ•°ä¸­ï¼Œç”¨ACD_Proc()è°ƒç”¨é‡‡æ ·åŠŸèƒ½ 12345678void ADC_Proc(void)&#123; char text[20]; adc_value1 = getADC(&amp;hadc1); adc_value2 = getADC(&amp;hadc2); sprintf(text,&quot;ADC1:%.2f,ADC2:%.2f&quot;,adc_value1,adc_value2); LCD_DisplayStringLine(Line4,(uint8_t *)text);&#125; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè®°å¾—åœ¨adc.cä¸­ä½¿ç”¨æ ¡å‡†å‡½æ•°å¯¹é‡‡æ ·è¿›è¡Œæ ¡å‡†ï¼Œå¦åˆ™é‡‡æ ·æœ€å¤§å€¼ä¸º3.25V 123456/* USER CODE BEGIN ADC1_Init 2 */HAL_ADCEx_Calibration_Start(&amp;hadc1,ADC_SINGLE_ENDED);/* USER CODE END ADC1_Init 2 *//* USER CODE BEGIN ADC2_Init 2 */HAL_ADCEx_Calibration_Start(&amp;hadc2,ADC_SINGLE_ENDED);/* USER CODE END ADC2_Init 2 */"},{"title":"KEY","path":"/wiki/lanqiao/KEY.html","content":"åµŒå…¥å¼æŒ‰é”®ä½¿ç”¨æŒ‰é”®çŠ¶æ€æœºï¼Œåœ¨ç”¨æˆ·åŒºæ–°å»ºKey_State.cå’ŒKey_State.hæ–‡ä»¶ã€‚åœ¨Key_State.hä¸­ï¼Œå†™ä¸‹ 123456789101112131415161718192021222324252627#ifndef __KEY_STATE_H_#define __KEY_STATE_H_#include &quot;main.h&quot;/** * @brief æŒ‰é”®çŠ¶æ€ç»“æ„ä½“ */struct keys&#123; uint8_t judge_state; // çŠ¶æ€æœºæ ‡å¿—ï¼Œ0ï¼š æ£€æµ‹åˆ°ä¸€ä¸ªä½ç”µå¹³ï¼›1ï¼šç¡®å®è¢«æŒ‰ä¸‹ï¼›2ï¼šç­‰å¾…æŠ¬èµ· uint8_t key_state; // æŒ‰é”®æ˜¯å¦è¢«æŒ‰ä¸‹ï¼ˆä¿¡å·æ¥è‡ªGPIOè¾“å…¥ï¼‰ uint8_t key_isPressed; // æŒ‰é”®çŸ­æŒ‰æ ‡å¿—ä½ uint8_t key_long_flag; // æŒ‰é”®é•¿æŒ‰æ ‡å¿—ä½ uint32_t key_time; // æŒ‰é”®è®¡æ—¶ uint32_t key_double_click_time; // åŒå‡»è®¡æ—¶å™¨ uint8_t key_double_click_EN; // åŒå‡»è®¡æ—¶å™¨ä½¿èƒ½ uint8_t key_double_click_flag; // åŒå‡»æ ‡å¿—ä½&#125;;extern struct keys key[];void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim);#endif keysç»“æ„ä½“å³ä¸ºæŒ‰é”®çŠ¶æ€æœºï¼Œä½¿ç”¨å®šæ—¶ä¸­æ–­å‡½æ•°è¿›è¡ŒæŒ‰é”®æ¶ˆæŠ–ã€‚ Key_State.cå†…å®¹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#include &quot;Key_State.h&quot;struct keys key[4] = &#123;0, 0, 0, 0&#125;;/** * @brief TIMå®šæ—¶å™¨å®šæ—¶ä¸­æ–­å›è°ƒå‡½æ•° */void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)&#123; if (htim-&gt;Instance == TIM3) &#123; key[0].key_state = HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_0); key[1].key_state = HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_1); key[2].key_state = HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_2); key[3].key_state = HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_0); for (uint8_t i = 0; i &lt; 4; i ++) &#123; if (key[i].key_double_click_EN == 1) // è®¡æ•°å™¨ä½¿èƒ½å¼€å¯æ—¶ï¼Œè®¡æ—¶å¹¶åˆ¤æ–­ &#123; key[i].key_double_click_time ++; if (key[i].key_double_click_time &gt; 35) // å¦‚æœè¶…æ—¶ï¼Œåˆ™è¯´æ˜æ˜¯çŸ­æŒ‰ï¼Œç½®æ ‡å¿—ä½åå…³é—­è®¡æ•°å™¨ä½¿èƒ½ &#123; key[i].key_isPressed = 1; key[i].key_double_click_EN = 0; &#125; &#125; switch (key[i].judge_state) &#123; case 0: if (key[i].key_state == 0) // å¦‚æœåˆšå¼€å§‹æ£€æµ‹åˆ°ä¸€ä¸ªä½ç”µå¹³ &#123; key[i].key_time = 0; // æ—¶é—´è®¡æ•°æ¸…0 key[i].judge_state = 1; &#125; break; case 1: if (key[i].key_state == 0) // å¦‚æœ10msåä¾ç„¶æ£€æµ‹åˆ°è¿™ä¸ªæŒ‰é”®æ˜¯ä½ç”µå¹³ï¼Œå°±è¯´æ˜è¿™ä¸ªæŒ‰é”®ç¡®å®è¢«æŒ‰ä¸‹äº† &#123; key[i].judge_state = 2; &#125; else &#123; key[i].judge_state = 0; &#125; break; case 2: if (key[i].key_state == 1 &amp;&amp; key[i].key_time &lt;= 70) // å¦‚æœæ˜¯ä¸€æ¬¡çŸ­æŒ‰ &#123; key[i].judge_state = 0; if (key[i].key_double_click_EN == 0) // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æŒ‰ä¸‹ &#123; key[i].key_double_click_EN = 1; key[i].key_double_click_time = 0; &#125; else // åŒå‡»è®¡æ—¶å¼€å¯ï¼Œè¯´æ˜è¿™æ¬¡çŸ­æŒ‰è¿˜åœ¨åŒå‡»è®¡æ—¶çš„æ—¶é—´èŒƒå›´å†… &#123; key[i].key_double_click_EN = 0; key[i].key_double_click_flag = 1; &#125; &#125; else if (key[i].key_state == 1 &amp;&amp; key[i].key_time &gt; 70) // é•¿æŒ‰æ¾å¼€æŒ‰é”®ï¼Œåˆ™å›åˆ°state0 &#123; key[i].judge_state = 0; &#125; else if (key[i].key_state == 0) // å¦‚æœæŒ‰é”®æ²¡æœ‰æ¾å¼€ï¼Œåˆ™æŒç»­è®¡æ—¶ &#123; key[i].key_time ++; if (key[i].key_time &gt; 70) // å¦‚æœæŒ‰é”®æŒ‰ä¸‹æ—¶é—´å¤§äº700ms &#123; key[i].key_long_flag = 1; &#125; &#125; break; default: break; &#125; &#125; &#125;&#125; è®°ä½è¦åœ¨cubemxä¸­è®¾ç½®10msä¸­æ–­ï¼Œå…¶ä¸­PSCé¢„åˆ†é¢‘æ˜¯79ï¼ˆ80-1ï¼‰ï¼ŒARRé‡è£…é¢„è½½æ˜¯9999ï¼ˆ10000-1ï¼‰ã€‚"},{"title":"LED","path":"/wiki/lanqiao/LED.html","content":"LEDæ“ä½œåœ¨cubemxä¸­é…ç½®æ—¶é’Ÿå’Œå¼•è„šï¼ŒLEDä½ç”µå¹³æœ‰æ•ˆ æ³¨æ„è¦æ‰“å¼€PD2é”å­˜å™¨ åŸºæœ¬å†™æ³•ï¼š 123456void LED(uint8_t dsled)&#123; HAL_GPIO_WritePin(GPIOD, GPIO_PIN_2, GPIO_PIN_SET); //æ‰“å¼€é”å­˜å™¨ HAL_GPIO_WritePin(GPIOC, GPIO_PIN_All, GPIO_PIN_SET); //ç­æ‰æ‰€æœ‰çš„LED HAL_GPIO_WritePin(GPIOC, dsled&lt;&lt;8, GPIO_PIN_RESET); //é€‰æ‹©ç‰¹å®šçš„LEDäº®èµ·&#125; å…¶ä¸­dsledæ˜¯8ä½æ— ç¬¦å·æ•°ï¼Œ0x_ _ã€‚ é«˜ä½å³ä¸ºå·¦è¾¹å››ä¸ªledï¼Œä½ä½å³ä¸ºå³è¾¹å››ä¸ªledã€‚æ¯ä¸€ä½å–1å³ä¸ºè¯¥ledäº®ã€‚ LEDäº¤æ›¿é—ªçƒå’ŒLEDé—ªçƒå–å ~ å·¦å››ä½å’Œå³å››ä½äº¤æ›¿é—ªçƒ å–å¼‚æˆ–^è¯¥ä½ledé—ªçƒ 1234567891011uint8_t ucLed=0x0f; //äº¤æ›¿é—ªçƒLED(~ucLed); //é—ªçƒuint8_t ucLed2 = 0x0f;LED(ucLed2);HAL_Delay(1000);ucLed2^=0x0f; LEDå®ç°æµæ°´ç¯ä½è¿ç®—å·¦ç§»å’Œå³ç§»ï¼ˆ&lt;&lt;å’Œ&gt;&gt;ï¼‰ Systick æ»´ç­”è®¡æ—¶HAL_Delay()æ˜¯é˜»å¡èµ‹å€¼ï¼Œå¯ä»¥ä½¿ç”¨Systickè¿›è¡Œè®¡æ—¶ï¼ŒSystickè¿›è¡Œäº†å·²ç»è®¾ç½®äº†1msçš„ä¸­æ–­ã€‚ è®¡æ—¶æ–¹å¼ 12345678910111213141516171819202122232425262728293031//åœ¨æ–‡ä»¶ï¼šstm32g4xx_it.cä¸­/* USER CODE BEGIN PV */extern uint32_t usled;/* USER CODE END PV */void SysTick_Handler(void)&#123;/* USER CODE BEGIN SysTick_IRQn 0 *//* USER CODE END SysTick_IRQn 0 */ HAL_IncTick();/* USER CODE BEGIN SysTick_IRQn 1 */ usled++;//å®ç°usledæ¯éš”1msè‡ªå¢1/* USER CODE END SysTick_IRQn 1 */&#125;//åœ¨æ–‡ä»¶main.cä¸­/* USER CODE BEGIN PV */uint32_t usled;uint8_t ucled=0x01;/* USER CODE END PV *//* USER CODE BEGIN 3 */Led_Disp(ucled);if(usled&gt;=500)//500msåˆ°&#123; usled=0;//é‡æ–°è®¡æ•° ucled^=0x01;//åè½¬led1&#125;/* USER CODE END 3 */ è§£å†³LEDå¼•è„šå†²çªé—®é¢˜ä¿®æ”¹PD2å¼•è„šä¸ºä½ç”µå¹³ å°†LEDæ˜¾ç¤ºå‡½æ•°æ”¹æˆå¦‚ä¸‹ï¼š 12345678910void Led_Disp(uint8_t ucled)&#123; HAL_GPIO_WritePin(GPIOC,0xFF&lt;&lt;8,GPIO_PIN_SET); HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_SET); HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET); HAL_GPIO_WritePin(GPIOC,ucled&lt;&lt;8,GPIO_PIN_RESET); HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_SET); HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET);&#125; å¢åŠ äº†é‡å†™PD2å¼•è„šé«˜ä½ç”µå¹³çš„å‡½æ•°"},{"title":"LCD","path":"/wiki/lanqiao/LCD.html","content":"åµŒå…¥å¼LCDæ ¹æ®åŸç†å›¾åœ¨cubemxé…ç½®å¼•è„šï¼Œåˆå§‹åŒ–lcdã€‚ 1234LCD_Init();LCD_Clear(Black);//é»‘è‰²æ¸…å±ï¼Œä¸ç„¶LCDåŸæœ¬é¢œè‰²è¿˜ä¼šæ®‹å­˜LCD_SetBackColor(Black);//è®¾ç½®èƒŒæ™¯è‰²ä¸ºé»‘è‰²LCD_SetTextColor(White);//è®¾ç½®å‰æ™¯è‰²ä¸ºç™½è‰² è®°ä½è¦åœ¨ MX_GPIO_Init() ä¹‹åï¼Œå¦åˆ™å¯èƒ½åˆå§‹åŒ–å¤±è´¥ã€‚ åœ¨lcdå±ä¸Šæ˜¾ç¤ºå­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨ void LCD_DisplayStringLine(u8 Line, u8 *ptr) ä¾‹å¦‚ï¼Œæ˜¾ç¤ºâ€Hello Worldâ€œ 1LCD_DisplayStringLine(Line4, (unsigned char *)&quot; Hello,world. &quot;); æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨sprintf()å‡½æ•°ï¼Œå‰æä½¿ç”¨stdioçš„å¤´æ–‡ä»¶ 12345#include &quot;stdio.h&quot;sprintf(text,&quot; count: %d &quot;,count);LCD_DisplayStringLine(Line4, (uint8_t *)text); è€ƒç‚¹1ï¼šå®ç°ç•Œé¢åˆ‡æ¢ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªæŒ‰é”®ç•Œé¢åˆ‡æ¢çš„åŸºæœ¬æ€è·¯ï¼Œé€šè¿‡æŒ‰é”®æ¥å¢åŠ ç•Œé¢è®¡æ•°ã€‚æ³¨æ„ä¸è¦å°†viewå’Œcountå®šä¹‰æˆå‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œå¦åˆ™åœ¨æ¯æ¬¡åŠ è½½è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ç•Œé¢éƒ½æ˜¯ç¬¬ä¸€ä¸ªç•Œé¢ï¼Œæ— æ³•è¿›è¡Œåˆ‡æ¢ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839// å…¨å±€å˜é‡uint8_t view = 0;uint8_t count = 0;void lcd_process(void)&#123; char text[30]; for(uint8_t i = 0;i &lt; 4; i++) &#123; if(key[0].key_isPressed == 1) &#123; view++; key[i].key_isPressed = 0; if(view ==3) &#123; view = 0; &#125; &#125; if(key[1].key_isPressed == 1) &#123; count++; key[1].key_isPressed = 0; &#125; &#125; if(view==0) &#123; LCD_DisplayStringLine(Line4, (unsigned char *)&quot; Hello,world. &quot;); &#125; if(view==1) &#123; sprintf(text,&quot; count: %d &quot;,count); LCD_DisplayStringLine(Line4, (uint8_t *)text); &#125; if(view == 2) &#123; LCD_DisplayStringLine(Line4,(unsigned char*)&quot; END &quot;); &#125;&#125; è€ƒç‚¹2ï¼šæ–‡æœ¬é«˜äº® æ²¡å•¥æŠ€æœ¯å«é‡ï¼Œæ›´æ”¹å¯¹åº”è¡Œçš„èƒŒæ™¯é¢œè‰²å’Œè®¾ç½®è¡Œåˆ‡æ¢æ ‡å¿— 12345678910111213141516171819202122232425262728293031323334353637383940414243if(view == 1) &#123; char text2[30]; if(line_flag == 0) &#123; LCD_SetBackColor(Green); sprintf(text2,&quot; count1:%d &quot;,count1); LCD_DisplayStringLine(Line4,(uint8_t *)text2); &#125; else &#123; LCD_SetBackColor(Black); sprintf(text2,&quot; count1:%d &quot;,count1); LCD_DisplayStringLine(Line4,(uint8_t *)text2); &#125; if(line_flag == 1) &#123; LCD_SetBackColor(Green); sprintf(text2,&quot; count2:%d &quot;,count2); LCD_DisplayStringLine(Line5,(uint8_t *)text2); &#125; else &#123; LCD_SetBackColor(Black); sprintf(text2,&quot; count2:%d &quot;,count2); LCD_DisplayStringLine(Line5,(uint8_t *)text2); &#125; if(line_flag == 2) &#123; LCD_SetBackColor(Green); sprintf(text2,&quot; count3:%d &quot;,count3); LCD_DisplayStringLine(Line6,(uint8_t *)text2); &#125; else &#123; LCD_SetBackColor(Black); sprintf(text2,&quot; count3:%d &quot;,count3); LCD_DisplayStringLine(Line6,(uint8_t *)text2); &#125; &#125; æ³¨æ„ï¼Œå½“ä¸¤ä¸ªç•Œé¢æ‰€éœ€è¦çš„è¡Œæ•°ä¸åŒæ—¶ï¼Œæ¯”å¦‚ï¼Œç•Œé¢1åªæœ‰ä¸€è¡Œå­—ç¬¦ä¸²ï¼Œç•Œé¢2æœ‰ä¸‰è¡Œå­—ç¬¦ä¸²ï¼Œéœ€è¦ç»™ç•Œé¢1å¢åŠ ä¸‰è¡Œç©ºå­—ç¬¦ä¸²ï¼Œå³ 123456789if(view == 0) &#123; char text1[30]; sprintf(text1,&quot; Hello,world. &quot;); LCD_SetBackColor(Black); LCD_DisplayStringLine(Line4, (uint8_t *)text1); LCD_DisplayStringLine(Line5, (unsigned char *)&quot; &quot;); LCD_DisplayStringLine(Line6, (unsigned char *)&quot; &quot;); &#125; å¦åˆ™ä¼šå‡ºç°ç•Œé¢ä¹‹é—´çš„å­—ç¬¦ä¸²ä¸²åœ¨ç•Œé¢ä¸­ã€‚"},{"title":"USART","path":"/wiki/lanqiao/USART.html","content":"åµŒå…¥å¼USARTå…ˆåœ¨cubemxé…ç½®USARTä¸­æ–­ï¼Œè°ƒè¯•æ—¶é…åˆä¸²å£è°ƒè¯•åŠ©æ‰‹ã€‚ æ³¨æ„å­—ç¬¦ä¸²æ“ä½œè¦ä½¿ç”¨stringåº“ è€ƒç‚¹1ï¼šä¸²å£å‘é€ä¾‹å¦‚ï¼Œå‘ä¸Šä½æœºå‘é€Hello World! 1234567891011121314151617char tx_buf[20]; //å­—ç¬¦ç¼“å­˜åŒºuint8_t rx_data; sprintf(tx_buf,&quot;Hello World!\\r &quot;);HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50);HAL_StatusTypeDef HAL_UART_Transmit(UART_HandleTypeDef *huart, const uint8_t *pData, uint16_t Size, uint32_t Timeout)/* * @param huart UART handle. * @param pData Pointer to data buffer (u8 or u16 data elements). * @param Size Amount of data elements (u8 or u16) to be sent. * @param Timeout Timeout duration. * @retval HAL status*/ è€ƒç‚¹2ï¼šä¸²å£æ¥æ”¶ä¸²å£æ¥æ”¶å‡½æ•°åœ¨HALåº“ä¸­çš„å®šä¹‰ 1234567891011/** * @brief Recive an amount of data in interrupt mode. * @note When UART parity is not enabled (PCE = 0), and Word Length is configured to 9 bits (M1-M0 = 01), * the received data is handled as a set of u16. In this case, Size must indicate the number * of u16 available through pData. * @param huart UART handle. * @param pData Pointer to data buffer (u8 or u16 data elements). * @param Size Amount of data elements (u8 or u16) to be received. * @retval HAL status */HAL_StatusTypeDef HAL_UART_Receive_IT(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size) è¿›è¡Œä¸²å£æ¥æ”¶æ—¶ï¼Œæˆ‘ä»¬è¦ç¼–å†™ä¸²å£ä¸­æ–­å‡½æ•°ï¼Œå‡½æ•°åå’Œå½¢å‚ä¸èƒ½æ”¹ï¼Œå‡½æ•°æœ¬èº«æ˜¯ç©ºå†…å®¹ï¼Œå’ŒTIMä¸­æ–­å‡½æ•°ä¸€è‡´ 1void HAL_UART_RxCpltCallback(UART_HandleTypedef *huart) ä¸²å£æ¥æ”¶åˆåˆ†ä¸ºå‡ ç§ï¼Œé¦–å…ˆæ˜¯å•å­—ç¬¦æ¥æ”¶ï¼Œä¾‹å¦‚ï¼Œæ¥æ”¶ä¸åŒçš„å•å­—ç¬¦æ¥å¯¹LED1è¿›è¡Œæ§åˆ¶ï¼š 12345678910111213141516171819202122void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart)&#123; if(rx_data==&#x27;O&#x27;) &#123; ucled=0x01; sprintf(tx_buf,&quot;LED1 Open!\\r &quot;); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); &#125; else if(rx_data==&#x27;C&#x27;) &#123; ucled=0x00; sprintf(tx_buf,&quot;LED1 Close!\\r &quot;); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); &#125; else &#123; sprintf(tx_buf,&quot;Error!\\r &quot;); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); &#125; HAL_UART_Receive_IT(&amp;huart1,&amp;rx_data,1); Led_Disp(ucled);&#125; è¦æå‰æ‰“å¼€æ¥æ”¶ä¸­æ–­ 123/* USER CODE BEGIN 2 */HAL_UART_Receive_IT(&amp;huart1,&amp;rx_data,1); //æ‰“å¼€æ¥æ”¶ä¸­æ–­/* USER CODE END 2 */ åªè¦æ¥æ”¶ä¸­æ–­å°±ä¼šè¿›å…¥ä¸²å£ä¸­æ–­å‡½æ•° å†ä¾‹å¦‚ï¼Œæ¥æ”¶å¤šå­—ç¬¦è¿›è¡ŒLEDæ§åˆ¶ï¼š 12345678910111213141516171819202122232425262728void Usart_Proc(void)&#123; if(rx_count==4) &#123; if(strcmp(rx_buf,&quot;LEDO&quot;)==0) &#123; ucled=0x01; Led_Disp(ucled); sprintf(tx_buf,&quot;LED Open!\\r &quot;); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); &#125; if(strcmp(rx_buf,&quot;LEDC&quot;)==0) &#123; ucled=0x00; Led_Disp(ucled); sprintf(tx_buf,&quot;LED Close!\\r &quot;); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); &#125; rx_count=0; memset(rx_buf,0,20); //å°†ç¼“å­˜æ¸…ç©º &#125; &#125;void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart)&#123; rx_buf[rx_count++]=rx_data; HAL_UART_Receive_IT(&amp;huart1,&amp;rx_data,1);&#125; åœ¨ä¸»å‡½æ•°ä¸»å¾ªç¯ä¸­ä½¿ç”¨Usart_Proc()å‡½æ•°ï¼ŒåŒæ ·çš„ï¼Œåœ¨æ¥æ”¶ä¸Šä½æœºå‘é€çš„ä¿¡æ¯åä¼šè¿›å…¥ä¸²å£ä¸­æ–­å‡½æ•°ï¼ŒåŒæ ·çš„ï¼Œè¦æå‰æ‰“å¼€æ¥æ”¶ä¸­æ–­ã€‚ è€ƒç‚¹3ï¼šsscanf()å‡½æ•°è§£æå­—ç¬¦ä¸²12345678int sscanf(const char* str, const char* format, ...);/*å‚æ•°ï¼šstrï¼šè¦è§£æçš„è¾“å…¥å­—ç¬¦ä¸²ã€‚formatï¼šæ ¼å¼å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šè¦åŒ¹é…çš„æ ¼å¼è§„åˆ™ã€‚...ï¼šå¯å˜å‚æ•°åˆ—è¡¨ï¼Œç”¨äºæ¥æ”¶è§£æåçš„æ•°æ®ã€‚*/ ä¾‹å¦‚ï¼Œçœèµ›ä¸­è§£æè½¦ç‰Œå­—ç¬¦ä¸²ï¼š 123456789101112131415void Usart_Proc(void)&#123; if(rx_count==22) &#123; sscanf(rx_buf,&quot;%4s:%4s:%12s&quot;,car_type,car_num,car_time); sprintf(tx_buf,&quot;car_type:%4s\\r &quot;,car_type); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); sprintf(tx_buf,&quot;car_num:%4s\\r &quot;,car_num); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); sprintf(tx_buf,&quot;car_time:%4s\\r &quot;,car_time); HAL_UART_Transmit(&amp;huart1,(uint8_t*)tx_buf,strlen(tx_buf),50); rx_count=0; memset(rx_buf,0,20); &#125;&#125;"}]